{% extends 'index.html' %}

{% block title %}Приватная страница{% endblock %}

{% block content %}
  <h1>Приватная страница</h1>

  <h2>Мои объявления</h2>
  <ul>
    {% for advert in adverts %}
      <li>
        <form action="{% url 'ads:delete-advert' pk=advert.pk %}" method="POST">
          {% csrf_token %}
          <button type="submit">Удалить</button>
        </form>
        <form action="{% url 'ads:update-advert' pk=advert.pk %}" method="POST">
          {% csrf_token %}
          <button type="submit">Изменить</button>
        </form>
        <a href="{% url 'ads:advert-detail' pk=advert.pk %}">{{ advert.title }}</a>
      </li>
    {% empty %}
      <li>У вас нет объявлений.</li>
    {% endfor %}
  </ul>

  <h2>Отклики на мои объявления</h2>
  <form action="{% url 'ads:private' %}" method="GET">
    <label for="filter-advert">Фильтровать по объявлению:</label>
    <select name="filter-advert" id="filter-advert">
      <option value="">Все объявления</option>
      {% for advert in adverts %}
        <option value="{{ advert.pk }}" {% if advert.pk|slugify == selected_advert %}selected{% endif %}>{{ advert.title }}</option>
      {% endfor %}
    </select>
    <button type="submit">Применить</button>
  </form>

  <ul>
    {% for response in responses %}
      <li>
        <h3>{{ response.advert.title }}</h3>
        <p>{{ response.response_text }}</p>
        <p>Likes: {{ response.likes }}</p>
        <p>Dislikes: {{ response.dislikes }}</p>
        <form action="{% url 'ads:delete-response' response_id=response.id %}" method="POST">
          {% csrf_token %}
          <button type="submit">Удалить отклик</button>
        </form>
        <form action="{% url 'ads:accept-response' response_id=response.id %}" method="POST">
          {% csrf_token %}
          <button type="submit">Принять отклик</button>
        </form>
      </li>
    {% empty %}
      <li>У вас нет откликов на объявления.</li>
    {% endfor %}
  </ul>
{% endblock %}
